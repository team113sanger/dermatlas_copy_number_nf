nextflow_workflow {

    name "Test Workflow ASCAT_ANALYSIS"
    script "subworkflows/ascat_analysis.nf"
    workflow "ASCAT_ANALYSIS"

    test("Should run without failures") {

        when {
            params {
                // define parameters here. Example:
                outdir = "tests/results"
            }
            workflow {
                """
                // define inputs of the workflow here. Example:
                input[0] = tuple(
                [pair_id: "PD54403a_PD54403b", normal: "PD54403a", tumor: "PD54403b", Sex: "M", Phenotype: "N", sexchr: "XY"], 
                file("/lustre/scratch124/jb63/ascat/bams/PD54403a/PD54403a.sample.dupmarked.bam"), 
                file("/lustre/scratch124/jb63/ascat/bams/PD54403a/PD54403a.sample.dupmarked.bam.bai"), 
                file("/lustre/scratch124/jb63/ascat/bams/PD54403b/PD54403b.sample.dupmarked.bam"),
                file("/lustre/scratch124/jb63/ascat/bams/PD54403b/PD54403b.sample.dupmarked.bam.bai"))
                input[2] = file("$baseDir/tests/testdata/sex2chr.txt")
                input[3] = "${params.outdir}"
                input[4] = file("${params.reference_genome}")
                input[5] = file("${params.bait_set}") 
                input[6] = file("${params.resource_files}")
                input[7] = file("${params.gc_file}")
                input[8] = file("${params.rt_file}")
                input[9] = "test"
                """
            }
        }

        then {
            assert workflow.success
            assert snapshot(workflow.out).match()
        }

    }

}
