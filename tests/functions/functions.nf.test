nextflow_function {

    name "Test Functions"
    script "functions/functions.nf"

    test("Test Function filter_ascat_qc_fails") {

        function "filter_ascat_qc_fails"

        when {
            function {
                """
                // Define inputs for the function here.
                input[0] = Channel.of(
                    tuple([pair_id: "PD54403a_PD54403b"], file('/path/to/PD54403b.segments.txt')),
                    tuple([pair_id: "PD12345_PD67890"], file('/path/to/PD67890.segments.txt'))
                )
                input[1] = Channel.value(file("$baseDir/tests/testdata/ascat_low_qual.list"))
                """
            }
        }

        then {
            assert function.success
            function.result.view { result -> 
                expected_result = [
                    tuple([pair_id: "PD54403a_PD54403b"], file('/path/to/PD54403b.segments.txt'))
                ]
                assert result == expected_result
            }
        }
    }
}
